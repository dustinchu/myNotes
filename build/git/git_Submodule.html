<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>git Submodule - 2</title><meta name="description" content="手把手帶大家動手做 Youtube Tutorial PART 1 - git Submodule tutorial - how to create submodule，"><meta name="keywords" content="git Submodule - 2"><script src="/static/js/jquery-3.3.1.min.js"></script><script src="/static/js/vue.min.js"></script><link rel="stylesheet" href="/static/css/normalize.min.css"><link rel="stylesheet" href="/static/css/monaco.css"><link rel="stylesheet" href="/static/css/loading.css"><link rel="stylesheet" href="/static/css/editormd.min.css"><link rel="stylesheet" href="/static/css/style.css"><link rel="stylesheet" href="/static/css/mobile.css"><link rel="stylesheet" href="/static/font-awesome-4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/static/css/highlight.default.min.css"><script src="/static/js/highlight.min.js"></script><script>window._CONST={ROOT_PATH:"/"},hljs.initHighlightingOnLoad()</script></head><body><div class="main"><div class="tea-menu"><div class="tea-menu-title"><i class="fa fa-home" aria-hidden="true"></i> <span>2</span></div><div class="tea-menu-search-warp"><i class="fa fa-search"></i> <input type="text" placeholder="搜索文档" value="" height="100%"></div><ul class="tea-menu-list"><li><a href="/index.html" title="介绍" class="">介绍</a></li><li><a href="/quick_start.html" title="快速入门" class="">快速入门</a></li><li><a href="/install.html" title="安装" class="">安装</a></li><li><a title="Dart" class="">Dart<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/dart/flutter.html" title="Flutter相關資源" class="">Flutter相關資源</a></li><li><a href="/dart/Learn.html" title="Flutter學習程式範例" class="">Flutter學習程式範例</a></li><li><a href="/dart/UI.html" title="FlutterUI相關" class="">FlutterUI相關</a></li><li><a href="/dart/flutterGithub.html" title="FlutterGithub相關" class="">FlutterGithub相關</a></li><li><a href="/dart/flutterLibrary.html" title="Flutter常用庫" class="">Flutter常用庫</a></li><li><a href="/dart/flutterOpenSource.html" title="Flutter範例+源代碼+youtube連結" class="">Flutter範例+源代碼+youtube連結</a></li><li><a href="/dart/FlutterJson.html" title="Flutter Json" class="">Flutter Json</a></li></ul></li><li><a title="Python" class="">Python<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a title="AI相關" class="">AI相關<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/python/ai.html" title="AI相關" class="">AI相關</a></li><li><a href="/python/ai/fastText.html" title="FACEBOOK 出的 自然語言學習 fastText" class="">FACEBOOK 出的 自然語言學習 fastText</a></li></ul></li><li><a href="/python/flask.html" title="Flask" class="">Flask</a></li><li><a title="日文相關" class="">日文相關<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/python/jp/jp.html" title="日文相關用法" class="">日文相關用法</a></li><li><a href="/python/jp/githubJp.html" title="語言數據的Python庫（中文，日文和韓文）" class="">語言數據的Python庫（中文，日文和韓文）</a></li><li><a href="/python/jp/githubJp1.html" title="日语词典终端版" class="">日语词典终端版</a></li><li><a href="/python/jp/githubJp2.html" title="基於遞歸神經網絡的日語標記器" class="">基於遞歸神經網絡的日語標記器</a></li><li><a href="/python/jp/githubJp3.html" title="日本負面積極分類。日本語文書のネガポジを判定。" class="">日本負面積極分類。日本語文書のネガポジを判定。</a></li><li><a href="/python/jp/githubjp4.html" title="用純Python編寫的日本形態分析引擎 " class="">用純Python編寫的日本形態分析引擎</a></li><li><a href="/python/jp/other.html" title="其他" class="">其他</a></li></ul></li><li><a href="/python/Library.html" title="一些好用庫" class="">一些好用庫</a></li><li><a title="爬蟲" class="">爬蟲<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/python/spider/other.html" title="爬蟲相關" class="">爬蟲相關</a></li></ul></li></ul></li><li><a title="其他" class="">其他<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/other/Record.html" title="其他紀錄" class="">其他紀錄</a></li><li><a href="/other/AnkiWen.html" title="AnkiWen" class="">AnkiWen</a></li><li><a href="/other/book.html" title="電子書相關" class="">電子書相關</a></li><li><a href="/other/data.html" title="機器學習深度學習資料" class="">機器學習深度學習資料</a></li><li><a href="/other/aidata.html" title="學習語料與資料" class="">學習語料與資料</a></li><li><a href="/other/ai.html" title="AI相關" class="">AI相關</a></li></ul></li><li><a title="Git" class="active">Git<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/git/Multiple_SSH_Keys.html" title="Multiple SSH Keys" class="">Multiple SSH Keys</a></li><li><a href="/git/git_Submodule.html" title="git Submodule" class="active">git Submodule</a></li><li><a href="/git/git_subtree.html" title="git_subtree">git_subtree</a></li><li><a href="/git/tuto.html" title="git基本用法">git基本用法</a></li></ul></li><li><a title="java">java<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/java/other.html" title="其他">其他</a></li><li><a title="DL4J">DL4J<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/java/dl4j/other.html" title="其他">其他</a></li><li><a href="/java/dl4j/wordVecGithub.html" title="WordVecGithub">WordVecGithub</a></li></ul></li><li><a title="電子書">電子書<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/java/book/javabook.html" title="Java工程师修炼之道 - 梳理Java知识体系">Java工程师修炼之道 - 梳理Java知识体系</a></li><li><a href="/java/book/bookvideo.html" title="開源項目詳細資料與影片">開源項目詳細資料與影片</a></li></ul></li><li><a title="Vaadin">Vaadin<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/java/vaadin/other.html" title="其他">其他</a></li><li><a href="/java/vaadin/css.html" title="CSS">CSS</a></li></ul></li><li><a title="Android">Android<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/java/android/other.html" title="其他">其他</a></li><li><a href="/java/android/tips.html" title="填坑手冊">填坑手冊</a></li></ul></li></ul></li><li><a href="/template_markdown.html" title="markdown模版">markdown模版</a></li><li><a href="/custom_theme.html" title="自定义主题">自定义主题</a></li><li><a href="/deploy.html" title="部署">部署</a></li></ul><div class="tea-version"><p>version: 0.0.1</p><p>Built with <a href="https://github.com/lisniuse/teadocs" target="_blank">Teadocs</a></p></div></div><div class="tea-content"><div class="tea-nav"><h3 class="top-title" style="font-weight:500;margin:0;font-size:16px"><i class="fa fa-navicon" aria-hidden="true"></i> <span>git Submodule</span></h3></div><div class="tea-container"><article class="markdown-body"><h1 id="git-Submodule-tutorial-:memo:"><a href="#git-Submodule-tutorial-:memo:" class="header-anchor">#</a> <span>git Submodule tutorial :memo:</span></h1><p>手把手帶大家動手做 <a href="https://youtu.be/IDMWLJCbCGo">Youtube Tutorial PART 1 - git Submodule tutorial - how to create submodule</a>，</p><p>git Submodule 的官方文件可參考 <a href="https://git-scm.com/docs/git-submodule/">git-submodule</a>。</p><p>在開始介紹前，我們先來談談何時會使用到 git Submodule，</p><p>大家一定有遇過這種情境，就是 A repo 依賴 B repo，這邊你可能會問我，</p><p>阿為什麼不直接把兩個 repo 變成一個 repo 就好呢 :question:</p><p>這樣不是增加遊戲困難度 :question:</p><p>有時候，這個 B repo 可能是 github 上一個很多人維護超強的東西，</p><p>你不可能自己維護，更何況，不要重造輪子，我們要站上巨人的肩膀上 :kissing_smiling_eyes:</p><p>好，現在我們拉回來，當每次我們發現 B repo 有更新時，我們以前的做法</p><p>可能就要單獨把他 clone 下來，然後在複製進我們的 A repo 中，</p><p>但其實這樣真的太土炮，而且非常沒有效率 :expressionless:</p><p>那我們該怎麼辦呢 :question:</p><p>有沒有一種東西，可以把它整合，甚至我們執行一個指令，就可以把全部</p><p>我們依賴的 repo 都做檢查並且更新，如果是這樣的話，整個流程會更安全，</p><p>也更不會出錯:relaxed:</p><p>答案是有的:thumbsup:</p><p>那就是我們接下來要介紹的 git Submodule，如果你也有上述的使用情境，</p><p>那你就更需要學習 git Submodule 了 :flushed:</p><p>再更簡單一點的說明，你可以把它想成是一個很大的主 repo，然後裡面依賴</p><p>很多 A repo、B repo、C repo 之類，而這些 A repo，B repo，C repo，你就可以</p><p>把它想成是 Submodule，這樣是不是更清楚了呢 :grin:</p><p>既然了解了使用情境，那我們就來看看它該怎麼使用:satisfied:</p><h2 id="how-to-create-submodule"><a href="#how-to-create-submodule" class="header-anchor">#</a> <span>how to create submodule</span></h2><p>手把手帶大家動手做 <a href="https://youtu.be/IDMWLJCbCGo">Youtube Tutorial PART 1 - git Submodule tutorial - how to create submodule</a>，</p><p>先介紹一下 repo ，這邊有兩個 repo，分別為 main_project repo 以及 a_project repo，</p><p>main_project repo 內容如下，</p><p><img src="https://i.imgur.com/mLaKJyX.png" alt="alt tag"></p><p>接著，我們要建立 a_project 為 Submodule，建立 Submodule 的語法如下，</p><pre class="prettyprint language-cmd"><code>git submodule add [&lt;options&gt;] [--] &lt;repository&gt; [&lt;path&gt;]</code></pre><p>實際範例</p><pre class="prettyprint language-cmd"><code>git submodule add git@blue.github.com:blue-rubiks/a_project.git</code></pre><p><img src="https://i.imgur.com/bexQ5Op.png" alt="alt tag"></p><p>這時候，你如果觀察資料夾，會發現多出一些東西</p><p><img src="https://i.imgur.com/djYEPu9.png" alt="alt tag"></p><p>也可以用 <code>git status</code> 觀察，</p><p><img src="https://i.imgur.com/I9jFYOb.png" alt="alt tag"></p><p>主要是多了 <code>.gitmodules</code> 以及 <code>a_project</code>，</p><p>可以看一下 <code>.gitmodules</code> 的內容，裡面就是 path 和 url</p><p><img src="https://i.imgur.com/kk8qfTE.png" alt="alt tag"></p><p>雖然表面上是兩個改動，但實際上卻還有一個改動，</p><p>它存在 <code>main_project/.git/config</code> 中</p><p><img src="https://i.imgur.com/mmyFYAk.png" alt="alt tag"></p><p>為什麼我要特別說這個，因為假如今天你想要移除 submodule，</p><p>你就必須到這裡移除和 submodule 相關的內容。</p><p>接著一些網路上的教學會說需要再執行以下兩個指令，</p><pre class="prettyprint language-cmd"><code>git submodule init
git submodule update</code></pre><p>但我自己測試似乎是不需要的 ( 雖然執行了也不會有什麼影響 )，</p><p>所以就先記錄就好，不要理它:smirk:</p><p>接著就一般 git 的操作後，push 就完成了:smiley:</p><p><img src="https://i.imgur.com/8c5ygMn.png" alt="alt tag"></p><p>可以使用 <code>git submodule status</code> 查看目前 submodule 的狀態</p><pre class="prettyprint language-cmd"><code>git submodule status</code></pre><p><img src="https://i.imgur.com/44bW6Bs.png" alt="alt tag"></p><p>push 之後，可以到 github 網頁上看，</p><p>會發現在 main_project repo 中的 submodule 有一個小圖示，</p><p>並且有一個 commit id，</p><p><img src="https://i.imgur.com/K0Z5tAa.png" alt="alt tag"></p><p>而這個 commit id，就是 a_project repo 中的 commit id，</p><p><img src="https://i.imgur.com/rcyWCGW.png" alt="alt tag"></p><p>學習完了如何建立 Submodule，接下來來看看如何更新 Submodule。</p><h2 id="how-to-update-submodule"><a href="#how-to-update-submodule" class="header-anchor">#</a> <span>how to update submodule</span></h2><p>手把手帶大家動手做 <a href="https://youtu.be/ogZoZOVyAYI">Youtube Tutorial PART 2 - git Submodule tutorial - how to update submodule</a>，</p><p>假設 a_project repo 也是我們自己維護的，當我們對它更新時，會發生什麼事情:question:</p><p>如果你進入 a_project repo 中，你會發現它其實就是一個我們常見的 git repo，</p><p>可以正常的 commit 以及 push，</p><p><img src="https://i.imgur.com/1REbrbK.png" alt="alt tag"></p><p><strong>只是你從外面 ( 也就是 main_project repo ) 看到的是像一種參照而已</strong>，</p><p>上面這句話很重要，因為我們現在更新了 a_project repo ，可是 main_project 並不</p><p>知道它有任何更新，切回 main_project repo 中，你會發現確實有更動，</p><p><img src="https://i.imgur.com/jlPgz8P.png" alt="alt tag"></p><p>所以這時候就必須要執行一般的 git 操作並且 push，</p><p><img src="https://i.imgur.com/bM8Ow3O.png" alt="alt tag"></p><p>這樣才算是成功，最後這一步驟 <strong>很重要</strong>，有些人會忘記，如果你沒有加上這步驟，</p><p>你的 main_project repo 就不知道 a_project repo 有做修改，儘管它是參照的概念，</p><p>還是需要此步驟。</p><p>剛剛我們是自己改動 a_project repo，現在另一種情境，是別人改動 a_project repo，</p><p>那這時候，我們如何更新 Submodule 呢:question:</p><p>剛剛說過如果我們進去 a_project repo 中，它就像一個正常的 git 一樣，</p><p>所以依照這個原則，</p><p>我只要進去 a_project repo 中，並切執行 <code>git pull</code> 即可，如下圖，</p><p>( 為了方便，我直接去 github 網頁端新增一個檔案，模擬有人更新 repo )</p><p><img src="https://i.imgur.com/M9noUKg.png" alt="alt tag"></p><p>但是，因為現在是只有一個 Submodule ，如果你有 N 個 Submodule 呢 ?</p><p>這樣我相信會非常麻煩，因為要一個一個更新:sob:</p><p>所以，比較好的方法應該是使用以下指令一次更新，</p><pre class="prettyprint language-cmd"><code>git submodule update --remote</code></pre><p>更多詳細的 update 可參考 <a href="https://git-scm.com/docs/git-submodule#git-submodule-update--init--remote-N--no-fetch--no-recommend-shallow-f--force--checkout--rebase--merge--referenceltrepositorygt--depthltdepthgt--recursive--jobsltngt--ltpathgt82308203">git-submodule-update</a>，</p><p><code>--remote</code> 的更多說明可以參考 <a href="https://git-scm.com/docs/git-submodule#git-submodule---remote">官方的說明</a>，</p><p><img src="https://i.imgur.com/m2ICwPY.png" alt="alt tag"></p><p>可是這時候你如果切到 a_project repo 你會發現它竟然 <strong>HEAD detached</strong> 了:confused:</p><p><img src="https://i.imgur.com/JHMn26S.png" alt="alt tag"></p><p>其實這是正常的，因為默認的行為會將它 checkout 到最新的 commit id 上，</p><p>以這個範例 <code>HEAD detached at 066d0db</code> 來說，</p><p>就是執行了 <code>git checkout &#39;066d0db&#39;</code>，所以我們要修正它，</p><p>修正方法如下圖，</p><p><img src="https://i.imgur.com/VfwxJW4.png" alt="alt tag"></p><p>簡單說就是要建立一個分支 ，然後再回到 master merge 該 ( <code>066d0db</code> ) 分支。</p><p>但這樣步驟真的有點多:sweat_smile:</p><p>所以更簡單的方法，可以直接使用以下指令，</p><pre class="prettyprint language-cmd"><code>git submodule update --remote --merge</code></pre><p><code>--merge</code> 的 <a href="https://git-scm.com/docs/git-submodule#git-submodule-merge">官方說明</a> 如下</p><pre class="prettyprint language-text"><code>the commit recorded in the superproject will be merged into the current branch in the submodule.</code></pre><p><img src="https://i.imgur.com/0YmQoP4.png" alt="alt tag"></p><p>或</p><pre class="prettyprint language-cmd"><code>git submodule update --remote --rebase</code></pre><p><code>--rebase</code> 的 <a href="https://git-scm.com/docs/git-submodule#git-submodule-rebase">官方說明</a> 如下</p><pre class="prettyprint language-text"><code>the current branch of the submodule will be rebased onto the commit recorded in the superproject.</code></pre><p><img src="https://i.imgur.com/MHLvL8T.png" alt="alt tag"></p><p>這種作法更方便，也解決了 <strong>HEAD detached</strong> 的問題 :thumbsup:</p><h2 id="how-to-clone-submodule"><a href="#how-to-clone-submodule" class="header-anchor">#</a> <span>how to clone submodule</span></h2><p>手把手帶大家動手做 <a href="https://youtu.be/f5_O5Iu6pJo">Youtube Tutorial PART 3 - git Submodule tutorial - how to clone submodule</a>，</p><p>這邊教大家如何 clone Submodule 的專案，執行一般的 clone 指令，</p><pre class="prettyprint language-cmd"><code>git clone git@github.com:blue-rubiks/main_project.git</code></pre><p>這時候我們看一下資料夾，</p><p><img src="https://i.imgur.com/aiTpngo.png" alt="alt tag"></p><p>的確有將 a_project repo 一起 clone 下來，但不要高興的太早，</p><p>因為，你如果進去看這些資料夾查看，你會發現它的內容都是空的:sob:</p><p><img src="https://i.imgur.com/xZuY1tm.png" alt="alt tag"></p><p>這時候，我們要先 init submodule，</p><pre class="prettyprint language-cmd"><code>git submodule init</code></pre><p><img src="https://i.imgur.com/bK6IzKW.png" alt="alt tag"></p><p>執行之後，它會將 <code>.gitmodules</code> 中的 url 寫入 <code>.git/config</code> 裡面，</p><p><img src="https://i.imgur.com/vknhZHR.png" alt="alt tag"></p><p>這時候，submodule 都設定好了，</p><p>只需要再執行 update ( update 會依照 <code>.git/config</code> 裡面的設定更新 )，</p><p>指令如下，</p><pre class="prettyprint language-cmd"><code> git submodule update --recursive</code></pre><p>以下為 <code>--recursive</code> 官方說明</p><pre class="prettyprint language-text"><code>If --recursive is specified, this command will recurse into the registered submodules, and update any nested submodules within.</code></pre><p><img src="https://i.imgur.com/SJFZW0U.png" alt="alt tag"></p><p>成功將 submodule 的內容 clone 下來了:smile:</p><p><img src="https://i.imgur.com/G9BXL77.png" alt="alt tag"></p><p>上面的兩段指令，也可以合併成一段，</p><pre class="prettyprint language-cmd"><code>git submodule update --init --recursive</code></pre><p>如果我們一開始就知道我們要 clone 的專案本身就有包含 submodule，</p><p>可以直接執行以下指令，</p><pre class="prettyprint language-cmd"><code>git clone --recurse-submodules git@github.com:blue-rubiks/main_project.git</code></pre><p>一次就完成全部的部分，包含 init 以及更新 submodule:satisfied:</p><p>詳細說明可參考 <a href="https://git-scm.com/docs/git-clone#git-clone---recurse-submodulesltpathspec">git-clone---recurse-submodulesltpathspec</a>，</p><p>但通常我們應該是不會一開始就知道這個專案有包含 submodule。</p><h3 id="how-to-remove-submodule"><a href="#how-to-remove-submodule" class="header-anchor">#</a> <span>how to remove submodule</span></h3><p>手把手帶大家動手做 <a href="https://youtu.be/imndFN7AvFA">Youtube Tutorial PART 4 - git Submodule tutorial - how to remove submodule</a>，</p><p>要移除 submodule 的步驟比較多，這邊教大家如何移除，</p><pre class="prettyprint language-cmd"><code>git submodule deinit a_project</code></pre><p><img src="https://i.imgur.com/YcUK6gU.png" alt="alt tag"></p><p>其實 deinit 就是刪除 <code>.git/config</code> 裡面的 submodule 相關設定，</p><p><img src="https://i.imgur.com/Ek30GqW.png" alt="alt tag"></p><p>接著打開 <code>.gitmodules</code> 移除相關的設定，在這邊因為我們只有一個 submodule，</p><p>所以直接將 <code>.gitmodules</code> 刪除即可。</p><p>( 如果只要刪除特定的 submodule，就進去刪除相關的部分 )</p><p>接著使用 git rm 指令，詳細用法可參考 <a href="https://git-scm.com/docs/git-rm">git-rm</a>，</p><pre class="prettyprint language-cmd"><code>git rm --cached a_project</code></pre><p><img src="https://i.imgur.com/YVHYuDE.png" alt="alt tag"></p><p>如果有加上 <code>--cached</code> ，本地端的 submodule repo 會被保留，所以</p><p>如果沒有要保留，可以不加上 <code>--cached</code>，將會把本地端的 submodule repo 刪除。</p><p>接著再移除 <code>.git/modules/a_project</code>，</p><pre class="prettyprint language-cmd"><code>rm -rf .git/modules/a_project</code></pre><p>接著就 <code>git add</code> 以及 <code>git commit</code></p><p><img src="https://i.imgur.com/LHCpjtg.png" alt="alt tag"></p><p>最後在把空的 a_project 資料夾刪除</p><pre class="prettyprint language-cmd"><code>rm -rf a_project</code></pre><p>步驟雖然多了點，但其實不難:smirk:</p><h3 id="Synchronizes-Submodule"><a href="#Synchronizes-Submodule" class="header-anchor">#</a> <span>Synchronizes Submodule</span></h3><p>詳細可參考 <a href="https://git-scm.com/docs/git-submodule#git-submodule-sync--recursive--ltpathgt82308203">git-submodule-sync</a></p><p>以下為官方說明</p><pre class="prettyprint language-text"><code>Synchronizes submodules' remote URL configuration setting to the value specified in .gitmodules.</code></pre><p>有時候如果 Submodule 的 remote url 有變更的時候，就需要使用此指令更新。</p><h2 id="Donation"><a href="#Donation" class="header-anchor">#</a> <span>Donation</span></h2><p>文章都是我自己研究內化後原創，如果有幫助到您，也想鼓勵我的話，歡迎請我喝一杯咖啡:laughing:</p><p><img src="https://i.imgur.com/LRct9xa.png" alt="alt tag"></p><p><a href="https://payment.opay.tw/Broadcaster/Donate/9E47FDEF85ABE383A0F5FC6A218606F8">贊助者付款</a></p><h2 id="License"><a href="#License" class="header-anchor">#</a> <span>License</span></h2><p>MIT license</p></article></div></div><i class="fa fa-arrow-circle-up gotop" aria-hidden="true"></i><div id="menu-mask"></div></div><script src="/static/js/main.js"></script><script src="/static/js/mobile.js"></script>
<script src="/__webscoket__/socket.io.js"></script>
<script src="/__webscoket__/socket.client.js"></script>
</body></html>